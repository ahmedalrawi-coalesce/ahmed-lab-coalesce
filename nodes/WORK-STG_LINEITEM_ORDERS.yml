fileVersion: 1
id: d6b1b1c6-9cca-4a27-9264-32c738cfa9a4
name: STG_LINEITEM_ORDERS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: WORK
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5791d57c-263d-4d5e-b24f-9e554927bebc
          stepCounter: d6b1b1c6-9cca-4a27-9264-32c738cfa9a4
        config: {}
        dataType: STRING
        description: ""
        name: LINEITEM_ORDERKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9c4b4d23-e7b3-4ff5-a7fe-fdd9e9308699
                stepCounter: 9287a836-abee-4f38-b722-375bcff5c773
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a74577c9-eead-4777-868f-91445276fa28
          stepCounter: d6b1b1c6-9cca-4a27-9264-32c738cfa9a4
        config: {}
        dataType: STRING
        description: ""
        name: LINEITEM_PARTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 0dbffc57-35b7-4726-936d-c908316747e5
                stepCounter: 9287a836-abee-4f38-b722-375bcff5c773
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c5544e6f-4810-44b8-9f54-f912a9eb4d71
          stepCounter: d6b1b1c6-9cca-4a27-9264-32c738cfa9a4
        config: {}
        dataType: STRING
        description: ""
        name: LINEITEM_SUPPKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7babb844-7bc8-4c8e-8567-4277aa3a8d0d
                stepCounter: 9287a836-abee-4f38-b722-375bcff5c773
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 17a641ea-6190-4382-a85e-5241dbaccd93
          stepCounter: d6b1b1c6-9cca-4a27-9264-32c738cfa9a4
        config: {}
        dataType: STRING
        description: ""
        name: LINEITEM_LINENUMBER
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cd178416-225a-4a10-9e1d-48f64cf02edb
                stepCounter: 9287a836-abee-4f38-b722-375bcff5c773
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97ddf551-397f-4da6-b55f-59805f7ae192
          stepCounter: d6b1b1c6-9cca-4a27-9264-32c738cfa9a4
        config: {}
        dataType: STRING
        description: ""
        name: LINEITEM_QUANTITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 549a1edb-8bca-4a31-8311-695b34e33d87
                stepCounter: 9287a836-abee-4f38-b722-375bcff5c773
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 08cab422-db77-42fc-868b-1e019cc54c0e
          stepCounter: d6b1b1c6-9cca-4a27-9264-32c738cfa9a4
        config: {}
        dataType: STRING
        description: ""
        name: LINEITEM_EXTENDEDPRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d909a834-fd99-470b-9655-7eaf6c01a8e0
                stepCounter: 9287a836-abee-4f38-b722-375bcff5c773
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7fc5571e-bc3f-4d41-8ac4-68e81b5efaa4
          stepCounter: d6b1b1c6-9cca-4a27-9264-32c738cfa9a4
        config: {}
        dataType: STRING
        description: ""
        name: LINEITEM_DISCOUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9407fc55-5c2a-491f-95a2-234f7042d6d0
                stepCounter: 9287a836-abee-4f38-b722-375bcff5c773
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5339f5f2-545c-4246-abb4-65b4684b72c5
          stepCounter: d6b1b1c6-9cca-4a27-9264-32c738cfa9a4
        config: {}
        dataType: STRING
        description: ""
        name: LINEITEM_TAX
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a179345e-2d44-4e3c-a5b9-9b16a24c9460
                stepCounter: 9287a836-abee-4f38-b722-375bcff5c773
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c01cf52c-4273-4424-bada-ee365ad40843
          stepCounter: d6b1b1c6-9cca-4a27-9264-32c738cfa9a4
        config: {}
        dataType: STRING
        description: ""
        name: LINEITEM_RETURNFLAG
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af3c1817-cf7b-4087-81bb-8f3944220a32
                stepCounter: 9287a836-abee-4f38-b722-375bcff5c773
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 28368483-1f59-4f4d-932d-a510f4b78b9b
          stepCounter: d6b1b1c6-9cca-4a27-9264-32c738cfa9a4
        config: {}
        dataType: STRING
        description: ""
        name: LINEITEM_LINESTATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3fc4ec2c-e4ea-4b05-8146-80ff8e9c0820
                stepCounter: 9287a836-abee-4f38-b722-375bcff5c773
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 01491491-bc58-48fc-84b2-d8b1ce6c63cc
          stepCounter: d6b1b1c6-9cca-4a27-9264-32c738cfa9a4
        config: {}
        dataType: STRING
        description: ""
        name: LINEITEM_SHIPDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 76632679-bace-442a-8c93-05e6e3c6dc97
                stepCounter: 9287a836-abee-4f38-b722-375bcff5c773
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 863c442e-d714-460f-8370-314e8623cedd
          stepCounter: d6b1b1c6-9cca-4a27-9264-32c738cfa9a4
        config: {}
        dataType: STRING
        description: ""
        name: LINEITEM_COMMITDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ee48aadb-0d7e-47b2-a812-5d8544194bed
                stepCounter: 9287a836-abee-4f38-b722-375bcff5c773
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2cc3a7f3-1611-45b3-ba64-4b824ca5b8b7
          stepCounter: d6b1b1c6-9cca-4a27-9264-32c738cfa9a4
        config: {}
        dataType: STRING
        description: ""
        name: LINEITEM_RECEIPTDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: beb6d1af-d34a-4e20-b5e4-0cebf657a44f
                stepCounter: 9287a836-abee-4f38-b722-375bcff5c773
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8fac9380-c78e-49cb-a9d4-dead3460eb6a
          stepCounter: d6b1b1c6-9cca-4a27-9264-32c738cfa9a4
        config: {}
        dataType: STRING
        description: ""
        name: LINEITEM_SHIPINSTRUCT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dcd2aae4-7c41-4144-a4af-67a758a0611c
                stepCounter: 9287a836-abee-4f38-b722-375bcff5c773
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6c1ddfbe-7821-4046-add0-faf4a4abd656
          stepCounter: d6b1b1c6-9cca-4a27-9264-32c738cfa9a4
        config: {}
        dataType: STRING
        description: ""
        name: LINEITEM_SHIPMODE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8484a102-92ca-4936-b2cf-b7d336be26ca
                stepCounter: 9287a836-abee-4f38-b722-375bcff5c773
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 09a42205-4fcb-413d-896d-cd5f8e078e27
          stepCounter: d6b1b1c6-9cca-4a27-9264-32c738cfa9a4
        config: {}
        dataType: STRING
        description: ""
        name: LINEITEM_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: cfbf2d50-1606-4690-8f85-a062bb54a0fc
                stepCounter: 9287a836-abee-4f38-b722-375bcff5c773
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6a59206-8c96-4548-8fa1-6f9adbb71802
          stepCounter: d6b1b1c6-9cca-4a27-9264-32c738cfa9a4
        config: {}
        dataType: STRING
        description: ""
        name: O_ORDERKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: bfeb73af-9135-4084-a13d-49d219d01219
                stepCounter: fbf2bee8-a514-4fb3-a144-04aff5a22a7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a314a789-fcc7-45b7-be4e-9adfcb8b40f2
          stepCounter: d6b1b1c6-9cca-4a27-9264-32c738cfa9a4
        config: {}
        dataType: STRING
        description: ""
        name: O_CUSTKEY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8795576a-6c1e-47d2-802d-e8435d9e4f85
                stepCounter: fbf2bee8-a514-4fb3-a144-04aff5a22a7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 2319ba2d-e7bf-4e88-a26f-128ec889bdba
          stepCounter: d6b1b1c6-9cca-4a27-9264-32c738cfa9a4
        config: {}
        dataType: STRING
        description: ""
        name: O_ORDERSTATUS
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f52544ea-a8fd-4451-93fa-4e35cfa8fcfb
                stepCounter: fbf2bee8-a514-4fb3-a144-04aff5a22a7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7ca9e09b-b70f-41c7-bdde-c4db127e49d3
          stepCounter: d6b1b1c6-9cca-4a27-9264-32c738cfa9a4
        config: {}
        dataType: STRING
        description: ""
        name: ORDER_TOTALPRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 36addbdc-ddc1-4135-a51c-b4a73c5fc5cc
                stepCounter: fbf2bee8-a514-4fb3-a144-04aff5a22a7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c395e0e6-b884-4c54-9f24-a136f5d1c9e4
          stepCounter: d6b1b1c6-9cca-4a27-9264-32c738cfa9a4
        config: {}
        dataType: STRING
        description: ""
        name: ORDER_TOTAL_ORDER_PRICE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 36addbdc-ddc1-4135-a51c-b4a73c5fc5cc
                stepCounter: fbf2bee8-a514-4fb3-a144-04aff5a22a7e
            transform: CASE WHEN "STG_LINEITEM"."L_LINENUMBER" = 1 THEN "STG_ORDERS"."O_TOTALPRICE" ELSE 0 END
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5be6f4a8-1875-4e48-8629-f63a06a8c662
          stepCounter: d6b1b1c6-9cca-4a27-9264-32c738cfa9a4
        config: {}
        dataType: STRING
        description: ""
        name: O_ORDERDATE
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f458955d-b64b-4de7-b3f4-6c46d4c10a52
                stepCounter: fbf2bee8-a514-4fb3-a144-04aff5a22a7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f936c9fe-98a1-41c0-9680-7a1ea5b52163
          stepCounter: d6b1b1c6-9cca-4a27-9264-32c738cfa9a4
        config: {}
        dataType: STRING
        description: ""
        name: O_ORDERPRIORITY_NUM
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6977d656-e5da-4fa3-adde-76378060b91e
                stepCounter: fbf2bee8-a514-4fb3-a144-04aff5a22a7e
            transform: SPLIT_PART("STG_ORDERS"."O_ORDERPRIORITY", '-', 1 )
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a2093061-1a48-42d5-902e-a733ec96cdef
          stepCounter: d6b1b1c6-9cca-4a27-9264-32c738cfa9a4
        config: {}
        dataType: STRING
        description: ""
        name: O_ORDERPRIORITY_DESC
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6977d656-e5da-4fa3-adde-76378060b91e
                stepCounter: fbf2bee8-a514-4fb3-a144-04aff5a22a7e
            transform: SPLIT_PART("STG_ORDERS"."O_ORDERPRIORITY", '-', 2 )
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c674e46-a9b4-4a67-93d9-a55c9dbf3e80
          stepCounter: d6b1b1c6-9cca-4a27-9264-32c738cfa9a4
        config: {}
        dataType: STRING
        description: ""
        name: ORDER_CLERK
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 33f1b583-2104-483f-bfbf-8912dbac326a
                stepCounter: fbf2bee8-a514-4fb3-a144-04aff5a22a7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8acce510-d91b-4a75-8d4b-c827af16f408
          stepCounter: d6b1b1c6-9cca-4a27-9264-32c738cfa9a4
        config: {}
        dataType: STRING
        description: ""
        name: O_SHIPPRIORITY
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 3cde9a50-b85f-4c63-8f2e-9a876dcbdf22
                stepCounter: fbf2bee8-a514-4fb3-a144-04aff5a22a7e
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4386ecb4-2209-458b-9bd5-4ee5178fce77
          stepCounter: d6b1b1c6-9cca-4a27-9264-32c738cfa9a4
        config: {}
        dataType: STRING
        description: ""
        name: O_COMMENT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f50d5c5-0023-43ac-943b-4704324bb8fb
                stepCounter: fbf2bee8-a514-4fb3-a144-04aff5a22a7e
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: a05cfe62-edc4-4569-a971-a8f8af5f1bc8
          stepCounter: d6b1b1c6-9cca-4a27-9264-32c738cfa9a4
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: DAYS_TO_SHIP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: DATEDIFF('DAY',"STG_ORDERS"."O_ORDERDATE","STG_LINEITEM"."L_SHIPDATE")
        systemColumnType: None
      - acceptedValues:
          strictMatch: false
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 03359918-6d17-413a-997a-8b7d1817b761
          stepCounter: d6b1b1c6-9cca-4a27-9264-32c738cfa9a4
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: PS_AVAILQTY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 9d35229a-e864-4159-9344-87949c0af433
                stepCounter: 9287a836-abee-4f38-b722-375bcff5c773
            transform: ""
      - acceptedValues:
          strictMatch: false
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: c59e1ad1-26d4-4ee3-bd8c-8bce579e1b1f
          stepCounter: d6b1b1c6-9cca-4a27-9264-32c738cfa9a4
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: PS_SUPPLYCOST
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 43deb37c-c07b-452a-b58b-0fb6bc884fc5
                stepCounter: 9287a836-abee-4f38-b722-375bcff5c773
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STG_LINEITEM: 9287a836-abee-4f38-b722-375bcff5c773
          STG_ORDERS: fbf2bee8-a514-4fb3-a144-04aff5a22a7e
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: WORK
            nodeName: STG_LINEITEM
          - locationName: WORK
            nodeName: STG_ORDERS
        join:
          joinCondition: |-
            FROM {{ ref('WORK', 'STG_LINEITEM') }} "STG_LINEITEM"
            INNER JOIN {{ ref('WORK', 'STG_ORDERS') }} "STG_ORDERS"
            ON "STG_LINEITEM"."L_ORDERKEY" = "STG_ORDERS"."O_ORDERKEY"
        name: STG_LINEITEM_ORDERS
        noLinkRefs: []
  name: STG_LINEITEM_ORDERS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
